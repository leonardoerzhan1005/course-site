import{$ as e}from"./jquery-T8mbjkVg.js";window.$=window.jQuery=e;const g=e('meta[name="csrf_token"]').attr("content"),m=e('meta[name="base_url"]').attr("content"),y=window.location.pathname.split("/").filter(Boolean),_=y.indexOf("admin"),h=_>-1&&y.length>_+1?y[_+1]:"",i=h?`${m}/admin/${h}`:`${m}/admin`,v=h?`${m}/${h}`:m,b=`${i}/courses/create`,$=`${i}/courses/update`;var l=new Notyf({duration:5e3,dismissible:!0}),f=`
<div class="modal-content text-center p-3" style="display:inline">
    <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>
`;function w(r,d){console.log("working"),e.ajax({method:"PUT",url:`${i}/courses/${r}/update-approval`,data:{_token:g,status:d},success:function(o){window.location.reload()},error:function(o,n,t){}})}e(function(){const r=e("select[name='faculty_id']"),d=e("select[name='specialty_id']");if(r.length&&d.length){let o=function(t){if(d.find("option:not(:first)").remove(),!t){d.trigger("change.select2");return}e.ajax({method:"GET",url:`${v}/api/specialties`,data:{faculty_id:t},success:function(a){(a||[]).forEach(function(s){const c=d.data("selected")==s.id?"selected":"";d.append(`<option value="${s.id}" ${c}>${s.name}</option>`)}),d.trigger("change.select2")}})};typeof e.fn.select2=="function"&&e(".select2").select2(),e.ajax({method:"GET",url:`${v}/api/faculties`,success:function(t){r.find("option:not(:first)").remove(),(t||[]).forEach(function(a){const s=r.data("selected")==a.id?"selected":"";r.append(`<option value="${a.id}" ${s}>${a.name}</option>`)}),r.trigger("change.select2")}});const n=r.data("selected")||r.val();n&&o(n),r.on("change",function(){o(e(this).val())})}e(".update-approval-status").on("change",function(){let o=e(this).data("id"),n=e(this).val();w(o,n)}),e(".course-tab").on("click",function(o){o.preventDefault();let n=e(this).data("step");e(".course-form").find("input[name=next_step]").val(n),e(".course-form").trigger("submit")}),e(".basic_info_form").on("submit",function(o){o.preventDefault();let n=new FormData(this);e.ajax({method:"POST",url:b,data:n,contentType:!1,processData:!1,beforeSend:function(){},success:function(t){t.status=="success"&&(window.location.href=t.redirect)},error:function(t,a,s){console.log(t);let c=t.responseJSON.errors;e.each(c,function(p,u){l.error(u[0])})},complete:function(){}})}),e(".basic_info_update_form").on("submit",function(o){o.preventDefault();let n=new FormData(this);e.ajax({method:"POST",url:$,data:n,contentType:!1,processData:!1,beforeSend:function(){},success:function(t){t.status=="success"&&(window.location.href=t.redirect)},error:function(t,a,s){let c=t.responseJSON.errors;e.each(c,function(p,u){l.error(u[0])})},complete:function(){}})}),e(".more_info_form").on("submit",function(o){o.preventDefault();let n=new FormData(this);e.ajax({method:"POST",url:$,data:n,contentType:!1,processData:!1,beforeSend:function(){},success:function(t){t.status=="success"&&(window.location.href=t.redirect)},error:function(t,a,s){let c=t.responseJSON.errors;e.each(c,function(p,u){l.error(u[0])})},complete:function(){}})}),e(document).on("change",".storage",function(){let o=e(this).val();e(".source_input").val(""),console.log("working"),o=="upload"?(e(".upload_source").removeClass("d-none"),e(".external_source").addClass("d-none")):(e(".upload_source").addClass("d-none"),e(".external_source").removeClass("d-none"))}),e(".dynamic-modal-btn").on("click",function(o){o.preventDefault(),e("#dynamic-modal").modal("show");let n=e(this).data("id"),t=e(this).data("url")||`${i}/course-content/${n}/create-chapter`;e.ajax({method:"GET",url:t,data:{},beforeSend:function(){e(".dynamic-modal-content").html(f)},success:function(a){e(".dynamic-modal-content").html(a)},error:function(a,s,c){}})}),e(".edit_chapter").on("click",function(o){o.preventDefault(),e("#dynamic-modal").modal("show");let n=e(this).data("chapter-id");e.ajax({method:"GET",url:`${i}/course-content/${n}/edit-chapter`,data:{},beforeSend:function(){e(".dynamic-modal-content").html(f)},success:function(t){e(".dynamic-modal-content").html(t)},error:function(t,a,s){}})}),e(".add_lesson").on("click",function(){e("#dynamic-modal").modal("show");let o=e(this).data("course-id"),n=e(this).data("chapter-id");e.ajax({method:"GET",url:`${i}/course-content/create-lesson`,data:{course_id:o,chapter_id:n},beforeSend:function(){e(".dynamic-modal-content").html(f)},success:function(t){e(".dynamic-modal-content").html(t)},error:function(t,a,s){}})}),e(".edit_lesson").on("click",function(){e("#dynamic-modal").modal("show");let o=e(this).data("course-id"),n=e(this).data("chapter-id"),t=e(this).data("lesson-id");e.ajax({method:"GET",url:`${i}/course-content/edit-lesson`,data:{course_id:o,chapter_id:n,lesson_id:t},beforeSend:function(){e(".dynamic-modal-content").html(f)},success:function(a){e(".dynamic-modal-content").html(a)},error:function(a,s,c){}})}),e(".sortable_list li").length&&e(".sortable_list").sortable({items:"li",containment:"parent",cursor:"move",handle:".dragger",update:function(o,n){let t=e(this).sortable("toArray",{attribute:"data-lesson-id"}),a=n.item.data("chapter-id");e.ajax({method:"POST",url:`${i}/course-chapter/${a}/sort-lesson`,data:{_token:g,order_ids:t},success:function(s){l.success(s.message)},error:function(s,c,p){l.error(data.error)}})}}),e(".sort_chapter_btn").on("click",function(){e("#dynamic-modal").modal("show");let o=e(this).data("id");e.ajax({method:"GET",url:`${i}/course-content/${o}/sort-chapter`,data:{},beforeSend:function(){e(".dynamic-modal-content").html(f)},success:function(n){e(".dynamic-modal-content").html(n)},error:function(n,t,a){l.error(a)}})})});
